function t(t,e,r){if(t[e]){var n=t[e];t[e]=function(t){n.call(this,t),r.call(this,t,e)}}else t[e]=function(t){r.call(this,t,e)}}function e(t){this[o.para.name]=o;var e={};t&&t.path&&(e.$urlPath=t.path),e.$isFirstTime=!!v,t.scene=t.scene||"未取到值",e.$scene=i.getMPScene(t.scene),o.registerParams({$latestScene:e.$scene}),o.para.autoTrack&&o.para.autoTrack.appLaunch&&o.autoTrackCustom("appLaunch",e,"$WXMPLaunch")}function r(t){var e={};m=(new Date).getTime(),t&&t.path&&(e.$urlPath=t.path),t.scene=t.scene||"未取到值",e.$scene=i.getMPScene(t.scene),o.registerParams({$latestScene:e.$scene}),o.para.autoTrack&&o.para.autoTrack.appShow&&o.autoTrackCustom("appShow",e,"$WXMPShow")}function n(){var t=(new Date).getTime(),e={};e.$urlPath=i.getCurrentPath(),m&&t-m>0&&(t-m)/36e5<24&&(e.eventDuration=(t-m)/1e3),o.para.autoTrack&&o.para.autoTrack.appHide&&o.autoTrackCustom("appHide",e,"$WXMPHide")}var i={},o={},a=require("./config.js");o.para=a;var s=Array.prototype,c=Function.prototype,u=Object.prototype,p=s.slice,f=u.toString,l=u.hasOwnProperty,h=["$WXMPLaunch","$WXMPShow","$WXMPHide","$WSMPViewScreen"],g={1001:"发现栏小程序主入口，“最近使用”列表",1005:"顶部搜索框的搜索结果页",1006:"发现栏小程序主入口搜索框的搜索结果页",1007:"单人聊天会话中的小程序消息卡片",1008:"群聊会话中的小程序消息卡片",1011:"扫描二维码",1012:"长按图片识别二维码",1013:"手机相册选取二维码",1014:"小程序模版消息",1017:"前往体验版的入口页",1019:"微信钱包",1020:"公众号 profile 页相关小程序列表",1022:"聊天顶部置顶小程序入口",1023:"安卓系统桌面图标",1024:"小程序 profile 页",1025:"扫描一维码",1026:"附近小程序列表",1027:"顶部搜索框搜索结果页“使用过的小程序”列表",1028:"我的卡包",1029:"卡券详情页",1030:"自动化测试下打开小程序",1031:"长按图片识别一维码",1032:"手机相册选取一维码",1034:"微信支付完成页",1035:"公众号自定义菜单",1036:"App 分享消息卡片",1037:"小程序打开小程序",1038:"从另一个小程序返回",1039:"摇电视",1042:"添加好友搜索框的搜索结果页",1043:"公众号模板消息",1044:"带 shareTicket 的小程序消息卡片（详情)",1045:"朋友圈广告",1046:"朋友圈广告详情页",1047:"扫描小程序码",1048:"长按图片识别小程序码",1049:"手机相册选取小程序码",1052:"卡券的适用门店列表",1053:"搜一搜的结果页",1054:"顶部搜索框小程序快捷入口",1056:"音乐播放器菜单",1057:"钱包中的银行卡详情页",1058:"公众号文章",1059:"体验版小程序绑定邀请页",1064:"微信连Wi-Fi状态栏",1067:"公众号文章广告",1068:"附近小程序列表广告",1069:"移动应用",1071:"钱包中的银行卡列表页",1072:"二维码收款页面",1073:"客服消息列表下发的小程序消息卡片",1074:"公众号会话下发的小程序消息卡片",1077:"摇周边",1078:"连Wi-Fi成功页",1079:"微信游戏中心",1081:"客服消息下发的文字链",1082:"公众号会话下发的文字链",1084:"朋友圈广告原生页",1089:"微信聊天主界面下拉",1090:"长按小程序右上角菜单唤出最近使用历史",1091:"公众号文章商品卡片",1092:"城市服务入口",1095:"小程序广告组件",1096:"聊天记录",1097:"微信支付签约页",1099:"页面内嵌插件",1102:"公众号 profile 页服务预览",1103:"发现栏小程序主入口，“我的小程序”列表",1104:"微信聊天主界面下拉，“我的小程序”栏"},d="直接打开",m=null,v=!1;o.libVersion="1.0.0";var _="object"==typeof _?_:{};if(_.info=function(){if(o.para.show_log&&"object"==typeof console&&console.log)try{return console.log.apply(console,arguments)}catch(t){console.log(arguments[0])}},function(){c.bind;var t=s.forEach,e=s.indexOf,r=Array.isArray,n={},o=i.each=function(e,r,i){if(null==e)return!1;if(t&&e.forEach===t)e.forEach(r,i);else if(e.length===+e.length){for(var o=0,a=e.length;o<a;o++)if(o in e&&r.call(i,e[o],o,e)===n)return!1}else for(var s in e)if(l.call(e,s)&&r.call(i,e[s],s,e)===n)return!1};i.logger=_,i.toCamelCase=function(t){return t.replace(/_([a-z])/g,function(t){return t[1].toUpperCase()})},i.extend=function(t){return o(p.call(arguments,1),function(e){for(var r in e)void 0!==e[r]&&(t[r]=e[r])}),t},i.extend2Lev=function(t){return o(p.call(arguments,1),function(e){for(var r in e)void 0!==e[r]&&(i.isObject(e[r])&&i.isObject(t[r])?i.extend(t[r],e[r]):t[r]=e[r])}),t},i.coverExtend=function(t){return o(p.call(arguments,1),function(e){for(var r in e)void 0!==e[r]&&void 0===t[r]&&(t[r]=e[r])}),t},i.isArray=r||function(t){return"[object Array]"===f.call(t)},i.isFunction=function(t){try{return/^\s*\bfunction\b/.test(t)}catch(t){return!1}},i.isArguments=function(t){return!(!t||!l.call(t,"callee"))},i.toArray=function(t){return t?t.toArray?t.toArray():i.isArray(t)?p.call(t):i.isArguments(t)?p.call(t):i.values(t):[]},i.values=function(t){var e=[];return null==t?e:(o(t,function(t){e[e.length]=t}),e)},i.include=function(t,r){var i=!1;return null==t?i:e&&t.indexOf===e?-1!=t.indexOf(r):(o(t,function(t){if(i||(i=t===r))return n}),i)}}(),i.trim=function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},i.isObject=function(t){return"[object Object]"==f.call(t)&&null!=t},i.isEmptyObject=function(t){if(i.isObject(t)){for(var e in t)if(l.call(t,e))return!1;return!0}return!1},i.isUndefined=function(t){return void 0===t},i.isString=function(t){return"[object String]"==f.call(t)},i.isDate=function(t){return"[object Date]"==f.call(t)},i.isBoolean=function(t){return"[object Boolean]"==f.call(t)},i.isNumber=function(t){return"[object Number]"==f.call(t)&&/[\d\.]+/.test(String(t))},i.isJSONString=function(t){try{JSON.parse(t)}catch(t){return!1}return!0},i.decodeURIComponent=function(t){var e="";try{e=decodeURIComponent(t)}catch(r){e=t}return e},i.encodeDates=function(t){return i.each(t,function(e,r){i.isDate(e)?t[r]=i.formatDate(e):i.isObject(e)&&(t[r]=i.encodeDates(e))}),t},i.formatDate=function(t){function e(t){return t<10?"0"+t:t}return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+e(t.getMilliseconds())},i.searchObjDate=function(t){i.isObject(t)&&i.each(t,function(e,r){i.isObject(e)?i.searchObjDate(t[r]):i.isDate(e)&&(t[r]=i.formatDate(e))})},i.formatString=function(t){return t.length>o.para.max_string_length?(_.info("字符串长度超过限制，已经做截取--"+t),t.slice(0,o.para.max_string_length)):t},i.searchObjString=function(t){i.isObject(t)&&i.each(t,function(e,r){i.isObject(e)?i.searchObjString(t[r]):i.isString(e)&&(t[r]=i.formatString(e))})},i.unique=function(t){for(var e,r=[],n={},i=0;i<t.length;i++)(e=t[i])in n||(n[e]=!0,r.push(e));return r},i.strip_dt_properties=function(t){if(!i.isObject(t))return t;var e=i.strip_empty_properties(t);return i.each(e,function(t,r){if(i.isArray(t)){var n=[];i.each(t,function(e){i.isString(e)||i.isNumber(e)?n.push(e):_.info("您的数据-",t,"的数组里的值必须是字符串,已经将其删除")}),0!==n.length?e[r]=n:(delete e[r],_.info("已经删除空的数组"))}i.isString(t)||i.isNumber(t)||i.isDate(t)||i.isBoolean(t)||i.isArray(t)||(_.info("您的数据-",t,"-格式不满足要求，我们已经将其删除"),delete e[r])}),e},i.strip_empty_properties=function(t){var e={};return i.each(t,function(t,r){null!=t&&(e[r]=t)}),e},i.utf8Encode=function(t){var e,r,n,i="",o=0;for(e=r=0,o=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,n=0;n<o;n++){var a=t.charCodeAt(n),s=null;a<128?r++:s=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),null!==s&&(r>e&&(i+=t.substring(e,r)),i+=s,e=r=n+1)}return r>e&&(i+=t.substring(e,t.length)),i},i.base64Encode=function(t){var e,r,n,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,u=0,p="",f=[];if(!t)return t;t=i.utf8Encode(t);do{e=(a=t.charCodeAt(c++)<<16|t.charCodeAt(c++)<<8|t.charCodeAt(c++))>>18&63,r=a>>12&63,n=a>>6&63,o=63&a,f[u++]=s.charAt(e)+s.charAt(r)+s.charAt(n)+s.charAt(o)}while(c<t.length);switch(p=f.join(""),t.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p},i.getCurrentPath=function(){var t="未取到";try{var e=getCurrentPages();e.length&&(t=e[e.length-1].route)}catch(t){_.info(t)}return t},i.getQueryParam=function(t,e){var r="[\\?&]"+e+"=([^&#]*)",n=new RegExp(r).exec(t);return null===n||n&&"string"!=typeof n[1]&&n[1].length?"":i.decodeURIComponent(n[1])},i.convertObjToParam=function(t){var e=[];for(var r in t)e.push(r+"="+t[r]);return e.join("&")},i.getObjFromQuery=function(t){var e=t.split("?"),r={};return e&&e[1]?(i.each(e[1].split("&"),function(t){var e=t.split("=");e[0]&&e[1]&&(r[e[0]]=e[1])}),r):{}},i.getMPScene=function(t){return"number"==typeof t||"string"==typeof t&&""!==t?(t=String(t))||g[t]:"未取到值"},i.info={userInfo:!1,properties:{$lib:"WXMP",$lib_version:String("1.0.0"),$brand:"devtools",$country:"",$province:"",$city:"",$nn:"",$gd:0,$au:""},getUserInfo:function(){var t=this.userInfo,e=this.properties;t||wx.getSetting({success:function(e){!t&&e.authSetting&&e.authSetting["scope.userInfo"]&&(t=!0)},complete:function(){wx.getUserInfo({success:function(r){e.$country=r.userInfo.country,e.$province=r.userInfo.province,e.$city=r.userInfo.city,e.$gd=r.userInfo.gender,e.$au=r.userInfo.avatarUrl,e.$nn=r.userInfo.nickName,t=!0}})}})},getSystem:function(){function t(){wx.getLocation({type:"wgs84",success:function(t){r.$latitude=t.latitude,r.$longitude=t.longitude,r.$speed=t.speed,r.$accuracy=t.accuracy},complete:function(){o.initialState.systemIsComplete=!0,o.initialState.checkIsComplete()}})}function e(){wx.getSystemInfo({success:function(t){r.$brand=t.brand,r.$model=t.model,r.$screenWidth=Number(t.windowWidth),r.$screenHeight=Number(t.windowHeight),r.$os=t.system.split(" ")[0],r.$osVersion=t.system.split(" ")[1],r.$wxVersion=t.version},complete:function(){a.getLocation?t():(o.initialState.systemIsComplete=!0,o.initialState.checkIsComplete(),i.info.getUserInfo())}})}var r=this.properties;wx.getNetworkType({success:function(t){r.$networkType=t.networkType},complete:e})}},o._=i,o.initialState={queue:[],isComplete:!1,systemIsComplete:!1,storeIsComplete:!1,checkIsComplete:function(){this.systemIsComplete&&this.storeIsComplete&&(this.isComplete=!0,this.queue.length>0&&(i.each(this.queue,function(t){o[t[0]].apply(o,p.call(t[1]))}),o.queue=[]))}},o.prepareData=function(t,e){var r={distinct_id:this.store.getDistinctId(),$lib:"WXMP",$lib_method:"code",$lib_version:String("1.0.0"),properties:{}};i.extend(r,t),i.isObject(t.properties)&&!i.isEmptyObject(t.properties)&&i.extend(r.properties,t.properties),t.type&&"profile"===t.type.slice(0,7)||(r.properties=i.extend({},i.info.properties,o.store.getProps(),r.properties),"object"==typeof o.store._state&&"number"==typeof o.store._state.first_visit_day_time&&o.store._state.first_visit_day_time>(new Date).getTime()?r.properties.$isFirstDay=!0:r.properties.$isFirstDay=!1),r.properties.$time&&i.isDate(r.properties.$time)?(r.time=1*r.properties.$time,delete r.properties.$time):o.para.use_client_time&&(r.time=1*new Date),r.properties.$urlPath||(r.properties.$urlPath=i.getCurrentPath()),i.searchObjDate(r),i.searchObjString(r),i.each(r.properties,function(t,e){r[e]=t}),delete r.properties,o.send(r,e)},o.store={storageInfo:null,getUUID:function(){return Date.now()+"-"+Math.floor(1e7*Math.random())+"-"+Math.random().toString(16).replace(".","")+"-"+String(31242*Math.random()).replace(".","").slice(0,8)},getStorage:function(){return this.storageInfo?this.storageInfo:(this.storageInfo=wx.getStorageSync("dtwave2018_wechat")||"",this.storageInfo)},_state:{},toState:function(t){var e=null;i.isJSONString(t)?(e=JSON.parse(t)).distinct_id?this._state=e:this.set("distinct_id",this.getUUID()):i.isObject(t)&&(e=t).distinct_id?this._state=e:this.set("distinct_id",this.getUUID())},getFirstId:function(){return this._state.first_id},getDistinctId:function(){return this._state.distinct_id},getProps:function(){return this._state.props||{}},setProps:function(t,e){var r=this._state.props||{};e?this.set("props",t):(i.extend(r,t),this.set("props",r))},set:function(t,e){var r={};"string"==typeof t?r[t]=e:"object"==typeof t&&(r=t),this._state=this._state||{};for(var n in r)this._state[n]=r[n];this.save()},change:function(t,e){this._state[t]=e},save:function(){wx.setStorageSync("dtwave2018_wechat",this._state)},init:function(){var t=this.getStorage();if(t)this.toState(t);else{v=!0;var e=new Date,r=e.getTime();e.setHours(23),e.setMinutes(59),e.setSeconds(60),this.set({distinct_id:this.getUUID(),first_visit_time:r,first_visit_day_time:e.getTime()})}}},o.registerParams=function(t){i.isObject(t)&&!i.isEmptyObject(t)&&(i.info.properties=i.extend(i.info.properties,t))},o.register=function(t){i.isObject(t)&&!i.isEmptyObject(t)&&o.store.setProps(t)},o.clearAllRegister=function(){o.store.setProps({},!0)},o.openid={getRequest:function(t){wx.login({success:function(e){e.code&&o.para.appid&&o.para.openid_url?wx.request({url:o.para.openid_url+"&code="+e.code+"&appid="+o.para.appid,method:"GET",complete:function(e){i.isObject(e)&&i.isObject(e.data)&&e.data.openid?t(e.data.openid):t()}}):t()}})},getWXStorage:function(){var t=o.store.getStorage();if(t&&i.isObject(t))return t.openid},getOpenid:function(t){if(!o.para.appid)return t(),!1;var e=this.getWXStorage();e?t(e):this.getRequest(t)}},o.initial=function(){this._.info.getSystem(),this.store.init(),i.isObject(this.para.register)&&(i.info.properties=i.extend(i.info.properties,this.para.register))},o.init=function(t){i.isObject(t)&&(o.para=i.extend(o.para,t)),o.initialState.storeIsComplete=!0,o.initialState.checkIsComplete()},o.getPresetProperties=function(){if(i.info&&i.info.properties&&i.info.properties.$lib){var t=i.extend({$urlPath:i.getCurrentPath()},i.info.properties,o.store.getProps());return delete t.$lib,t}return{}},i.autoExeQueue=function(){return{items:[],enqueue:function(t){this.items.push(t),this.start()},dequeue:function(){return this.items.shift()},getCurrentItem:function(){return this.items[0]},isRun:!1,start:function(){this.items.length>0&&!this.isRun&&(this.isRun=!0,this.getCurrentItem().start())},close:function(){this.dequeue(),this.isRun=!1,this.start()}}},o.requestQueue=function(t){this.url=t.url},o.requestQueue.prototype.isEnd=function(){this.received||(this.received=!0,this.close())},o.requestQueue.prototype.start=function(){var t=this;setTimeout(function(){t.isEnd()},o.para.send_timeout),wx.request({url:this.url,method:"GET",complete:function(){t.isEnd()}})},o.dataQueue=i.autoExeQueue(),o.send=function(t){i.info.getUserInfo();var e="";(t=i.strip_dt_properties(t))._nocache=(String(Math.random())+String(Math.random())+String(Math.random())).slice(2,15),_.info(t),t=JSON.stringify(t),e=-1!==o.para.server_url.indexOf("?")?o.para.server_url+"&data="+encodeURIComponent(i.base64Encode(t)):o.para.server_url+"?data="+encodeURIComponent(i.base64Encode(t));var r=new o.requestQueue({url:e});r.close=function(){o.dataQueue.close()},o.dataQueue.enqueue(r)},o.track=function(t,e,r){h.indexOf(t)>=0&&(e.$isDefaultTrack=!0,e.$project_id=this.para.project_id||""),this.prepareData({type:"track",event_name:t,properties:e},r)},o.autoTrackCustom=function(t,e,r){var n=o.para.autoTrack[t],a="";o.para.autoTrack&&n&&("function"==typeof n?(a=n(),i.isObject(a)&&i.extend(e,a)):i.isObject(n)&&(i.extend(e,n),o.para.autoTrack[t]=!0),o.track(r,e))},i.each(["track","register","clearAllRegister","autoTrackCustom","registerParams"],function(t){var e=o[t];o[t]=function(){o.initialState.isComplete?e.apply(o,arguments):o.initialState.queue.push([t,arguments])}}),!1!==o.para.autoTrack){var y=App;App=function(i){t(i,"onLaunch",e),t(i,"onShow",r),t(i,"onHide",n),y(i)};var S=Page;Page=function(e){if(t(e,"onLoad",function(t){if(t&&i.isObject(t)){var e=i.extend({},t);if(t.q&&i.extend(e,i.getObjFromQuery(i.decodeURIComponent(t.q))),t.scene){var r=t.scene;r=-1!==(r=i.decodeURIComponent(r)).indexOf("?")?"?"+r.replace(/\?/g,""):"?"+r,i.extend(e,i.getObjFromQuery(r))}}}),t(e,"onShow",function(){var t="系统没有取到值";"object"==typeof this&&("string"==typeof this.route?t=this.route:"string"==typeof this.__route__&&(t=this.__route__));var e={};e.$referrer=d,e.$urlPath=t,this.sensors_mp_load_utm&&(i.extend(e,this.sensors_mp_load_utm),this.sensors_mp_load_utm=null),o.para.onshow?o.para.onshow(sa,t,this):o.autoTrackCustom("pageShow",e,"$WXMPViewScreen"),d=t}),"function"==typeof e.onShareAppMessage){var r=e.onShareAppMessage;e.onShareAppMessage=function(){o.para.autoTrack&&o.para.autoTrack.pageShare&&o.autoTrackCustom("pageShare",{$urlPath:i.getCurrentPath(),$shareDepth:i.getShareDepth()},"$WXMPShare");var t=r.apply(this,arguments);return o.para.allow_amend_share_path&&"string"==typeof t.path&&-1!==t.path.indexOf("/")&&(-1===t.path.indexOf("?")?t.path=t.path+"?":"&"!==t.path.slice(-1)&&(t.path=t.path+"&"),t.path=t.path+"shareinfo="+encodeURIComponent(i.getShareInfo())),t}}S.apply(this,arguments)}}o.initial(),module.exports=o;